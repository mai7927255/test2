<HTML>
<style type='text/css'>
	.embeddedServiceHelpButton .helpButton .uiButton {
		background-color: #FFD400;
		font-family: "Krungsri", sans-serif;
	}
	.embeddedServiceHelpButton .helpButton .uiButton:focus {
		outline: 1px solid #FFD400;
	}
</style>

<script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
<script type='text/javascript'>
var initESW = function (gslbBaseURL) {
        embedded_svc.settings.displayHelpButton = true; //Or false
        embedded_svc.settings.language = 'th'; //For example, enter 'en' or 'en-US'

        //embedded_svc.settings.defaultMinimizedText = '...'; //(Defaults to Chat with an Expert)
        //embedded_svc.settings.disabledMinimizedText = '...'; //(Defaults to Agent Offline)

        //embedded_svc.settings.loadingText = ''; //(Defaults to Loading)
        //embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

        // Settings for Chat
        //embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
        // Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
        // Returns a valid button ID.
        //};
        //embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
        //embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
        //embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)
        embedded_svc.settings.extraPrechatFormDetails = [{ "value": window.location.href, "transcriptFields": ["ReferrerUri"] },
        { "value": "0120K000000q2ixQAA", "transcriptFields": ["RecordTypeId"] },//edit recordtypeid
        { "value": "Thai", "label": "Language", "displayToAgent": true },
        { "value": "Live Chat", "label": "Origin", "displayToAgent": true },
        { "value": "Live Chat - Krungsri.com", "label": "Channel", "displayToAgent": true }];

	//แก้
embedded_svc.settings.extraPrechatInfo = [{
  	  "entityName": "Account",
  	  "linkToEntityName": "Case",
  	  "linkToEntityField": "AccountId",
  	  "entityFieldMaps": [{
    		"isExactMatch": true,
    		"fieldName": "First_Name_Thai_Encrypted__c",
    		"doCreate": true,
    		"doFind": true,
    		"label": "ชื่อ"
  	  },{
    		"isExactMatch": true,
    		"fieldName": "Last_Name_Thai_Encrypted__c",
    		"doCreate": true,
    		"doFind": true,
    		"label": "นามสกุล"
  	}]
}];

        embedded_svc.settings.enabledFeatures = ['LiveAgent'];
        embedded_svc.settings.entryFeature = 'LiveAgent';
        embedded_svc.settings.autoOpenPostChat = true;
        embedded_svc.settings.widgetWidth = '350px';

        /*embedded_svc.init(
            'https://krungsri--ccuat.my.salesforce.com',
            'https://ccuat-krungsri.cs111.force.com/liveAgentSetupFlow',
            gslbBaseURL,
            '00D1e0000008ae8',
            'Krungsri_CC_Non_Voice_Krungsri_Website',
            {
                baseLiveAgentContentURL: 'https://c.la2-c1cs-ukb.salesforceliveagent.com/content',
                deploymentId: '5721e0000008OKf',
                buttonId: '5731e0000008OKr',
                baseLiveAgentURL: 'https://d.la2-c1cs-ukb.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'EmbeddedServiceLiveAgent_Parent04I1y0000004CBEEA2_170c91a6dbc',
                isOfflineSupportEnabled: false
            }
        );*/

        embedded_svc.init(
            'https://krungsri--full.sandbox.my.salesforce.com',
            'https://krungsri--full.sandbox.my.salesforce-sites.com/liveAgentSetupFlow',
            gslbBaseURL,
            '00D0w0000002kjF',
            'Krungsri_CC_Non_Voice_Krungsri_Website',
            {
                baseLiveAgentContentURL: 'https://c.la1-c1cs-ukb.salesforceliveagent.com/content',
                deploymentId: '5720K000000Cl1k',
                buttonId: '5730K000000GxK3',
                baseLiveAgentURL: 'https://d.la1-c1cs-ukb.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'EmbeddedServiceLiveAgent_Parent04I1y0000004CBEEA2_170c91a6dbc',
                isOfflineSupportEnabled: false
            }
        );

        embedded_svc.addEventHandler("onSettingsCallCompleted", function (data) {
            $(".embeddedServiceHelpButton .helpButton .uiButton").append("<i class='fal fa-comment-alt-lines'></i>");
        });
        embedded_svc.addEventHandler("afterMaximize", function (data) {
            $(".minimizedContainer.embeddedServiceSidebarMinimizedDefaultUI i").remove();
            $(".minimizedContainer.embeddedServiceSidebarMinimizedDefaultUI").append("<i class='fal fa-comment-alt-lines'></i>");
            if (typeof $("#chat_pdpa").val() === "undefined") {
                $(".fieldList .inputSelect").append("<div id='chat_pdpa' style='text-align: left;font-size: 12px;'>ท่านสามารถอ่านประกาศการคุ้มครองข้อมูลส่วนบุคคลได้ที่<br /> <a href='https://www.krungsri.com/pdpa/privacy-notice-th' target='blank'>https://www.krungsri.com/pdpa/privacy-notice-th</a></div>");
            }
        });
    };

    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://krungsri--ccuat.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function () {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
</script>
</HTML>
